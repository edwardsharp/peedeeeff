<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>PEE-DEE-EFF</title>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
                font-family: sans-serif;
                height: 100%;
                background: black;
                color: white;
            }
            a,
            a:link,
            a:visited,
            a:active {
                color: black;
            }
            a:hover {
                color: white;
            }
            header {
                text-align: center;
            }
            footer {
                text-align: right;
            }
            header h1 {
                display: flex;
                flex-direction: row;
                justify-content: space-evenly;
                font-size: 1rem;
                margin: 0;
            }
            header,
            footer {
                height: 2.5rem;
                display: flex;
                align-content: center;
            }

            header div,
            footer div {
                flex-grow: 1;
            }
            header h1 {
                background: magenta;
                color: black;
                height: 100%;
                display: block;
                line-height: 2.5rem;
                width: 220px;
                padding-right: 1rem;
                box-sizing: border-box;
            }
            body {
                display: flex;
                flex-direction: column;
                height: 100dvh;
            }
            main {
                display: flex;
                flex: 1;
                overflow: hidden;
            }
            nav {
                width: 220px;
                min-width: 220px;
                max-width: 220px;
                box-sizing: border-box;
                overflow-y: auto;
            }
            nav h2 {
                padding: 0 1rem;
                font-size: 1.25rem;
            }
            nav em {
                font-size: 0.75rem;
                display: block;
                padding: 0.5rem 0px;
            }
            nav label {
                border-bottom: thick solid magenta;
                padding: 0 1rem;
            }
            nav label:last-of-type {
                border-bottom: none;
            }

            #hamburger:hover {
                cursor: context-menu;
            }
            #madewith {
                position: sticky;
                bottom: 0;
                font-size: 0.75em;
                font-weight: 100;
                background: magenta;
                color: black;
                text-align: center;

                display: block;
                line-height: 2.5rem;
                width: 220px;
                padding: 0.25rem 1rem;
                box-sizing: border-box;
            }
            main > webp-peedeeeff {
                flex: 1;
                height: 100%;
            }
            .scroll-message {
                font-size: 2rem;
                background: white;
                color: black;
                z-index: 1;
            }
            form label {
                display: block;
                margin-top: 1rem;
            }
            form input[type="text"],
            form input[type="number"] {
                width: 100%;
                padding: 0.25rem;
                margin-top: 0.25rem;
                box-sizing: border-box;
            }

            @media screen and (max-width: 600px) {
                footer {
                    display: none;
                }
                header.hidden {
                    position: absolute;
                    top: 0;
                    right: 0;
                    width: 200px;
                    z-index: 2;
                }
            }
        </style>
    </head>
    <body>
        <header id="header">
            <div>&nbsp;</div>
            <h1 id="hamburger" title="🍔 toggle controlz">
                P E E - D E E - E F F
            </h1>
        </header>
        <main>
            <pee-dee-eff
                id="peedeeeff"
                last-page="6"
                base-path="example/undoinganddoing"
                loop="false"
                background="black"
                single-boundary="false"
                scroll-mode="false"
                horizontal-scroll-mode="false"
                one-atta-time="true"
            >
                <div
                    class="scroll-message"
                    slot="scroll-message"
                    title="i'm scrollin' ovah heeeere!"
                >
                    scroll down 👇
                </div>
            </pee-dee-eff>

            <nav id="nav">
                <h2>controlz</h2>
                <form id="peedeeeffForm">
                    <label>
                        base-path
                        <input
                            type="text"
                            name="base-path"
                            value="example/undoinganddoing"
                        />
                        <em
                            >base path to webp files named like
                            page-000.webp</em
                        >
                    </label>

                    <label>
                        last-page
                        <input
                            type="number"
                            name="last-page"
                            value="11"
                            min="0"
                        />
                        <em>total page range (the last page-XXX.webp file)</em>
                    </label>

                    <label>
                        <input type="checkbox" name="loop" /> loop

                        <em
                            >if horizontal scroll, will loop start and end</em
                        ></label
                    >

                    <label>
                        <input type="checkbox" name="single-boundary" />
                        single-boundary
                        <em
                            >1 up display of first and last page, all other are
                            2 up</em
                        >
                    </label>

                    <label>
                        <input type="checkbox" name="one-atta-time" checked />
                        one-atta-time
                        <em>only display one page/image at a time</em>
                    </label>

                    <label>
                        <input type="checkbox" name="scroll-mode" /> vertical
                        scroll
                        <em
                            >vertical scroll (disables horizontal scroll
                            mode)</em
                        >
                    </label>

                    <label>
                        <input type="checkbox" name="horizontal-scroll-mode" />
                        horizontal scroll
                        <em
                            >horizontal scroll (doesn't use prev/next page
                            buttons)</em
                        >
                    </label>

                    <label>
                        background
                        <input type="text" name="background" value="black" />
                        <em>background color behind webp images</em>
                    </label>
                </form>
                <a id="madewith" href="https://github.com/edwardsharp/peedeeeff"
                    >madewith 💖 in nyc</a
                >
            </nav>
        </main>
        <footer>
            <div>&nbsp;</div>
        </footer>
        <script>
            const hamburger = document.getElementById("hamburger");
            const nav = document.getElementById("nav");
            const header = document.getElementById("header");
            let hidden = false;
            hamburger.addEventListener("click", () => {
                nav.style.display = hidden ? "block" : "none";

                if (hidden) {
                    header.classList.remove("hidden");
                } else {
                    header.classList.add("hidden");
                }
                hidden = !hidden;
            });

            const form = document.getElementById("peedeeeffForm");
            window.peedeeeff = document.getElementById("peedeeeff");

            const props = [
                "base-path",
                "last-page",
                "loop",
                "single-boundary",
                "one-atta-time",
                "scroll-mode",
                "horizontal-scroll-mode",
                "background",
            ];

            props.forEach((prop) => {
                const input = form.elements[prop];
                if (!input) return;

                input.addEventListener("input", () =>
                    updatepeedeeeff(prop, input),
                );
                input.addEventListener("change", () =>
                    updatepeedeeeff(prop, input),
                );
            });

            function updatepeedeeeff(prop, input) {
                if (input.type === "checkbox") {
                    if (input.checked) {
                        window.peedeeeff.setAttribute(prop, "true");
                    } else {
                        window.peedeeeff.removeAttribute(prop);
                    }
                } else {
                    window.peedeeeff.setAttribute(prop, input.value);
                }

                const newpeedeeeff = window.peedeeeff.cloneNode(true);
                window.peedeeeff.replaceWith(newpeedeeeff);
                newpeedeeeff.id = "peedeeeff";
                window.peedeeeff = newpeedeeeff;

                syncControlStates();
            }

            function syncControlStates() {
                const scrollMode = form.elements["scroll-mode"].checked;
                const hScrollMode =
                    form.elements["horizontal-scroll-mode"].checked;

                form.elements["scroll-mode"].disabled = hScrollMode;
                form.elements["horizontal-scroll-mode"].disabled = scrollMode;

                // so then disable loop opt if either checked
                const loop = form.elements["loop"];
                loop.disabled = scrollMode || hScrollMode;

                const singleBoundryEl = form.elements["single-boundary"];
                const oneAttaTimeEl = form.elements["one-atta-time"];
                oneAttaTimeEl.disabled = singleBoundryEl.checked;
                singleBoundryEl.disabled = oneAttaTimeEl.checked;
            }

            syncControlStates();
        </script>
        <script src="peedeeeff.js"></script>
    </body>
</html>
